module Tritium::Engines::Reference::Scope
  module NodeModules
    module PositioningMethods
     
      def position_node(target, node, position = nil)
        position ||= var("position") || "bottom"
        throw("this can only be called with a bottom, after, or before block") if position.nil?

        if node.is_a?(String)
          node = target.document.fragment(node)
        end

        case position
        when "top"
          if target.children.size > 0
            target.children.first.add_previous_sibling(node)
          else
            target.add_child(node)
          end
        when "after"
          target.add_next_sibling(node)
        when "before"
          target.add_previous_sibling(node)
        else
          target.add_child(node)
        end
      end
    end
  end
end